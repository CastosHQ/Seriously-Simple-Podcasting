jQuery(document).ready(function(d){function h(l){d(".peek-a-bar").hide().remove();var k=new d.peekABar({padding:"1em",animation:{type:"fade",duration:1000},cssClass:"ssp-notification-bar",backgroundColor:"#4aa3df"});k.show({html:l})}function a(l){var k=l.type;var m=k.split("/");var n=false;if("audio"==m[0]||"video"==m[0]){n=true}return n}if(typeof upload_credentials!="undefined"){var b=upload_credentials.bucket;var i=upload_credentials.show_slug;var f=upload_credentials.episodes_url;var j=upload_credentials.access_key_id;var g=upload_credentials.policy;var c=upload_credentials.signature;var e=new plupload.Uploader({runtimes:"html5",browse_button:"ssp_select_file",multi_selection:false,container:"ssp_upload_container",url:"https://"+b+".s3.amazonaws.com:443/",multipart_params:{key:i+"/${filename}",Filename:i+"/${filename}",acl:"public-read","Content-Type":"",AWSAccessKeyId:j,policy:g,signature:c}});e.init();e.bind("Init",function(){d("#ssp_upload_notification").remove()});e.bind("FilesAdded",function(k,m){var l=m[0];if(a(l)){h('Uploading file to Seriously Simple Hosting. You can continue editing this post while the file uploads. <b id="ssp_upload_progress"></b>');e.start()}else{h("You have selected an invalid file type, please select a valid audio or video file.")}});e.bind("Error",function(k,l){alert("Error #"+l.code+": "+l.message)});e.bind("UploadProgress",function(k,l){d("#ssp_upload_progress").html(l.percent+"%")});e.bind("UploadComplete",function(l,q){h("Processing Seriously Simple Hosting file.");var p=q[0];var n=p.size;var k=plupload.formatSize(p.size);var m="https://s3.amazonaws.com/"+b+"/"+i+"/"+p.name;var o=f+i+"/"+p.name;d.ajax({method:"GET",url:ajaxurl,data:{action:"ssp_store_podmotor_file",podmotor_file_path:m}}).done(function(r){if(r.status=="success"){h("Uploading file to Seriously Simple Hosting Complete.");d("#podmotor_file_id").val(r.file_id);d("#filesize_raw").val(n);d("#filesize").val(k);d("#duration").val(r.file_duration);d("#upload_audio_file").val(o);d(".peek-a-bar").fadeOut(5000)}else{h(r.message)}})})}});