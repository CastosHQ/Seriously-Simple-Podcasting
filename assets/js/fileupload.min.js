jQuery(document).ready(function(c){function e(g){c(".peek-a-bar").hide().remove();var f=new c.peekABar({padding:"1em",animation:{type:"fade",duration:1000},cssClass:"ssp-notification-bar",backgroundColor:"#4aa3df"});f.show({html:g})}function b(g){var f=g.type;var h=f.split("/");var i=false;if("audio"===h[0]||"video"===h[0]){i=true}return i}function a(f){var g=f.replace(/[,\/#!$%\^&\*;:{}=\-_`'~()+"|? ]/g," ");return g.replace(/\s{1,}/g,"-")}if(typeof upload_credentials!="undefined"){var d=new plupload.Uploader({runtimes:"html5",browse_button:"ssp_select_file",multi_selection:false,container:"ssp_upload_container",url:upload_credentials.castos_api_url+"files"});d.init();d.bind("Init",function(){c("#ssp_upload_notification").remove()});d.bind("FilesAdded",function(f,h){var g=h[0];if(b(g)){e('Uploading file to Castos Hosting. You can continue editing this post while the file uploads. <b id="ssp_upload_progress"></b>');d.start()}else{e("You have selected an invalid file type, please select a valid audio or video file.");d.removeFile(g)}});d.bind("BeforeUpload",function(g,h){var i=a(h.name);var f={token:upload_credentials.castos_api_token,episode_id:upload_credentials.castos_episode_id,file_name:i};d.settings.multipart_params=f});d.bind("Error",function(f,g){alert("Error #"+g.code+": "+g.message)});d.bind("UploadProgress",function(f,g){c("#ssp_upload_progress").html(g.percent+"%");if(g.percent===100){e("Processing Castos Hosting file.")}});d.bind("FileUploaded",function(g,i,f){e("Uploading file to Castos Hosting Complete.");var h=JSON.parse(f.response);if(h.status===200){var i=h.file;c("#podmotor_file_id").val(i.id);c("#filesize_raw").val(i.file_size);c("#filesize").val(plupload.formatSize(i.file_size));c("#duration").val(i.file_duration);c("#upload_audio_file").val(i.file_path);c(".peek-a-bar").fadeOut(5000)}});d.bind("UploadComplete",function(f,g){c(".peek-a-bar").fadeOut(5000)})}});